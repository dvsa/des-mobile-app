<ion-content class="content-background">
  <ion-grid class="max-width">
    <ion-searchbar
      [id]="'searchbar' | formatToID: idPrefix"
      [placeholder]="placeholder"
      [ngModel]="model ? model[displayKey] : searchedValue"
      (ionChange)="onSearchbarChange($event)"
      (ionClear)="onSearchbarClear()">
    </ion-searchbar>

    <!-- Check if minimum number of required chars entered or custom template -->
    <div *ngIf="hasEnteredSufficientCharacters; else insufficientCharsEntered;">
      <!-- Check if rendered list has any data inside it or custom template -->
      <div *ngIf="(dataList | doesContain: fuzzySearchKeys: searchedValue)?.length > 0; else noResults;">
        <!-- Filter dataList using custom doesContain pipe -->
        <ion-item
          *ngFor="let data of dataList | doesContain: fuzzySearchKeys: searchedValue; trackBy: trackBy;"
          [id]="data[displayKey] | formatToID: idPrefix"
          (click)="onClick(data)">
          <ion-col [ngClass]="conditionalStyles(data)">{{data[displayKey]}}</ion-col>

          <ion-col class="button-style" size="6">
            <ion-icon *ngIf="isActiveSelection(data)" name="checkmark-sharp" class="checkmark"></ion-icon>
          </ion-col>
        </ion-item>
      </div>
    </div>

    <ng-template #insufficientCharsEntered>
      <ion-item>
        <ion-col>
          <b id="searchable-picklist-please-enter-min-chars-msg">
            Please enter a minimum of {{minCharactersBeforeListDisplay}} character(s)
          </b>
        </ion-col>
      </ion-item>
    </ng-template>

    <ng-template #noResults>
      <ion-item>
        <ion-col>
          <b id="searchable-picklist-no-results-msg">
            No results found
          </b>
        </ion-col>
      </ion-item>
    </ng-template>
  </ion-grid>
</ion-content>
